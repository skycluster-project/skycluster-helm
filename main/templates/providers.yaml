{{ if .Values.install }}
  {{ range $provider := .Values.providers.public }}
    {{ range $group, $spec := $provider }}
      {{ if $spec.enabled }}
apiVersion: pkg.crossplane.io/v1
kind: Provider
metadata:
  name: {{ $spec.name }}
  labels:
    skycluster.io/managed-by: skycluster
spec:
  package: xpkg.upbound.io/upbound/{{ $spec.name }}:{{ $spec.version }}
---
      {{ end }}
    {{ end }}
  {{ end -}} # End of range .Values.providers.public
############################################################
  {{- range $key, $provider := .Values.providers.community }}
    {{- if $provider.enabled }}
      {{- if or (eq $key "kubernetes") (eq $key "helm") }}
apiVersion: pkg.crossplane.io/v1
kind: Provider
metadata:
  name: {{ $provider.name }}
  labels:
    skycluster.io/managed-by: skycluster
spec:
  package: xpkg.upbound.io/upbound/{{ $provider.name }}:{{ $provider.version }}
  runtimeConfigRef:
    apiVersion: pkg.crossplane.io/v1beta1
    kind: DeploymentRuntimeConfig
    name: {{ $provider.name }}
---
      {{- else }}
apiVersion: pkg.crossplane.io/v1
kind: Provider
metadata:
  name: {{ $provider.name }}
  labels:
    skycluster.io/managed-by: skycluster
spec:
  {{ if $provider.repo -}}
  package: {{ $provider.repo }}:{{ $provider.version }}
  {{ else -}}
  package: xpkg.upbound.io/crossplane-contrib/{{ $provider.name }}:{{ $provider.version }}
  {{ end -}}
      {{ end -}}
    {{- end }}
---
  {{ end -}} # End of range .Values.providers.community
############################################################

{{ end -}} # End of .Values.install